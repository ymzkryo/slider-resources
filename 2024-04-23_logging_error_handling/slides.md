---
theme: seriph
background: https://source.unsplash.com/collection/94734566/1920x1080
class: text-center
highlighter: shiki
info: |
  ## 2024-04-23_logging_error_handling
  Presentation slides for 2024-04-23_logging_error_handling.
transition: slide-left
title: 2024-04-23_logging_error_handling
mdc: true
githubPages:
  ogp: true

---

# ロギングとエラーハンドリング

---

# 講義のアジェンダ

- はじめに
- ロギング設計
- FastAPIでのロギング
- エラーハンドリング設計
- FastAPIでのエラーハンドリング
- Q&A
- おわりに

---

# はじめに

- ロギングとエラーハンドリングの定義
- 目的と重要性

<!--このセクションでは、ロギングとエラーハンドリングの基本的な定義から始めます。
ロギングとは、システムの実行時に発生したイベントを記録するプロセスである。エラーハンドリングは、プログラム実行中に発生したエラーを適切に処理する方法に関するものです。
ここでは、これらがなぜ開発プロセスにおいて重要であるのかについても説明します。
それでは、詳しく見ていきましょう。-->

---

# ロギングとエラーハンドリングの定義

- **ロギング**:
  - システムの実行時に発生したイベントを記録するプロセス
- **エラーハンドリング**:
  - プログラム実行中に発生したエラーを適切に処理する方法

<!--このスライドでは、ロギングとエラーハンドリングの基本的な定義について説明します。

まずロギングですが、これはシステムの実行中に発生する様々なイベントやデータを記録することです。これにより、後で何が起こったのかを確認でき、問題解決やパフォーマンス改善のための貴重な情報源となります。

次にエラーハンドリングについてです。これは、プログラムの実行中に予期せぬエラーが発生した場合に、それを捉えて適切に対処するプロセスを指します。エラーハンドリングにより、プログラムがクラッシュすることなく、エラーをログに記録し、ユーザーに適切なフィードバックを提供できます。

これらの概念は、ソフトウェア開発のあらゆる段階で非常に重要です。それでは、これらの概念を深掘りしていきましょう。-->

---

# ロギングの目的と重要性

- **目的**:
  - システムの動作状況と異常を記録し、可視化する。
  - 開発および運用中の問題解析と迅速なトラブルシューティングを支援する。

- **重要性**:
  - システムの正常な動作を保証し、エラーや不具合の早期発見に貢献する。
  - パフォーマンスの監視と最適化を可能にし、ユーザーエクスペリエンスを向上させる。
  - セキュリティ違反の検出と分析に不可欠。

<!--ロギングの目的は、システムの動作を透明にし、問題が発生したときにそれを特定しやすくすることにあります。これにより、開発チームは迅速に対応し、システムの正常な動作を維持することができます。

ロギングの重要性は非常に大きく、システム運用の基盤とも言えます。エラーや問題を早期に発見し、修正することで、システムの安定性を保つことができます。また、パフォーマンスのモニタリングを通じて、システムの最適化を図ることも可能です。セキュリティ面では、不正アクセスやデータ漏洩などのリスクを把握し、対策を講じるための重要な情報源となります。
-->

---

# エラーハンドリングの目的と重要性

- **目的**:
  - プログラムの実行中に発生したエラーを安全に処理し、プログラムのクラッシュを防ぐ。
  - ユーザーに対して適切なフィードバックを提供し、問題の解決を支援する。

- **重要性**:
  - システムの信頼性と堅牢性を確保し、ユーザーの信頼を維持する。
  - エラー発生時の適切な対応により、システムのダウンタイムを最小限に抑える。
  - 開発者がエラーの原因を迅速に特定し、修正することを容易にする。

<!--エラーハンドリングは、プログラム実行中のエラーを適切に管理し、より安定したシステム運用を目指すために不可欠です。これにより、ユーザーが直面する問題を最小限に抑え、より良い体験を提供することができます。

その重要性は、特にユーザーの信頼と直結しています。エラーが適切に処理されることで、システムはより信頼性高く、堅牢なものになります。また、問題発生時に迅速に対応することで、システムのダウンタイムを減らし、ビジネスへの影響を最小限に抑えることが可能です。開発者にとっては、エラーハンドリングを通じて問題の原因を特定しやすくなり、修正作業の効率が向上します。
-->

---

# ロギング設計

- ロギングの目的と基本原則
- local開発環境 vs. production環境
- ロギングレベルと使用例
- ログのフォーマットと構造

<!--このセクションでは、ロギングの設計について深く掘り下げていきます。ロギングの目的は多岐にわたりますが、主にシステムの透明性を高め、問題解決を助けることにあります。基本的に、ロギングはシステム運用の重要な側面であり、効果的なロギング戦略は開発から運用までのあらゆる段階で価値を提供します。

まず、ロギングの目的と基本原則についてですが、ロギングはシステムの動作を理解し、問題が発生した際に原因を追究するための手段を提供します。ここで重要なのは、何を、いつ、どのようにログに記録するかを明確に定義することです。また、ログを生成することのパフォーマンスへの影響を最小限に抑えることも考慮する必要があります。

次に、local開発環境とproduction環境におけるロギングの違いに触れます。開発環境では、デバッグや問題解析を容易にするために詳細なログが必要になることがあります。一方で、production環境では、パフォーマンスへの影響を考慮し、エラーログや重要な情報のみを記録することが一般的です。

ロギングレベルについては、DEBUG、INFO、WARNING、ERROR、CRITICALといったレベルが存在し、それぞれのレベルは異なる重要度の情報を表します。使用例を通じて、これらのレベルを適切に使い分けることの重要性について話します。

最後に、ログのフォーマットと構造についてです。ログの有用性はその内容と構造に大きく依存します。一般的に、タイムスタンプ、ログレベル、メッセージ、エラーコードなどを含めることが推奨されます。ログを構造化することで、分析や監視ツールによる処理が容易になります。

それでは、各ポイントについて詳しく見ていきましょう。
-->

---

# ロギングの目的と基本原則

- **目的**:
  - システムの動作状況を記録し、可視化する
  - 問題の早期発見と迅速なトラブルシューティングを支援する
  - 運用の透明性を高め、システムの信頼性を確保する

- **基本原則**:
  - 必要最小限の情報を記録する
  - ログのパフォーマンスへの影響を最小限に抑える
  - システムのセキュリティを損なわない情報のみをログに記録する
  - ログの構造を一貫させ、分析しやすくする
<!--ロギングの主な目的は、システムの動作状況を記録し、問題が発生した際に原因を特定できるようにすることです。これにより、運用の透明性が高まり、エラーや不具合の早期発見に繋がります。また、システムの信頼性を維持し、最終的にはユーザーの満足度を向上させることができます。

しかし、効果的なロギングを実現するためには、いくつかの基本原則を理解し、実践する必要があります。第一に、ログに記録する情報は必要最小限に抑えるべきです。これは、パフォーマンスへの影響を最小限に抑え、ログファイルのサイズを管理可能に保つためです。また、ログに記録する情報が多すぎると、重要な情報を見逃す可能性があります。

次に、ログのパフォーマンスへの影響を常に意識することが重要です。ロギングはシステムのパフォーマンスに影響を与えるため、効率的なロギング戦略が求められます。さらに、セキュリティを損なうような情報はログに記録すべきではありません。例えば、ユーザーの個人情報やパスワードなどがこれに該当します。

最後に、ログの構造を一貫させることで、ログの分析が容易になります。一貫したフォーマットを使用することで、ログ分析ツールを効果的に活用できるようになります。

それでは、これらの原則に基づいて、ロギング戦略をどのように設計していくか見ていきましょう。
-->

---

# local開発環境 vs. production環境

- **local開発環境**:
  - デバッグやトラブルシューティングを容易にするために詳細なログを出力する。
  - パフォーマンスへの影響が少ない環境で、より多くの情報を提供する。

- **production環境**:
  - ユーザーデータやシステムの安全性を考慮して、重要な情報のみをログに記録する。
  - パフォーマンスやリソースの消費を最小限に抑えるために、ログレベルを適切に設定する。

<!--ロギングの設計を考える上で、local開発環境とproduction環境では異なるアプローチが必要です。開発環境では、問題解析やデバッグのために詳細なログが求められます。これにより、開発者はコードの挙動を深く理解し、問題の原因を迅速に特定できるようになります。例えば、DEBUGレベルのログを豊富に出力して、システムの内部動作を詳細に追跡することがあります。

一方、production環境では、システムのパフォーマンスやセキュリティが最優先事項となります。ユーザー体験に影響を与えることなく、また機密情報を守りながら、重要なイベントやエラー情報のみを記録することが求められます。これは、ERRORやWARNINGといったより高いログレベルに設定を限定し、ログの量を抑えることで実現されます。また、不正アクセスの試みやシステムの重大な障害など、セキュリティ上重要な情報を捉えるために、適切なアラートや監視システムと組み合わせることが一般的です。

要するに、開発環境と本番環境では、ロギングの目的が異なります。開発環境では詳細な情報が役立ちますが、本番環境ではシステムの安定性とセキュリティが最も重要となるため、ログの量や種類を厳選する必要があります。

それでは、これらの環境ごとに適切なロギング戦略をどのように選択するか、詳しく見ていきましょう。
-->

---

# ロギングレベルと使用例

---

# ログのフォーマットと構造

---

# FastAPIでのロギング

- 設定方法
- ベストプラクティスと例

---

# 設定方法

---

# ベストプラクティスと例

---

# エラーハンドリング設計
- エラーの種類と例外処理
- カスタムエラーの定義と使用方法

---

# エラーの種類と例外処理

---

# カスタムエラーの定義と使用方法

---

# FastAPIでのエラーハンドリング
- 設定方法
- ベストプラクティスと例

---

# 設定方法

---

# ベストプラクティスと例

---

# Q&A

## 質疑応答のセッション

---

## おわりに

- ロギングとエラーハンドリングの実践
- さらなる資源と学習のためのリンク
